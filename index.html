<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prompt Library</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;900&family=Noto+Sans+JP:wght@300;400;500&family=IBM+Plex+Mono:wght@400;500&display=swap');
* { box-sizing: border-box; margin: 0; padding: 0; }
html { overflow-x: hidden; }
body { background: #f5f3ee; color: #1a1814; font-family: 'Noto Sans JP', sans-serif; font-weight: 300; line-height: 1.6; min-height: 100vh; overflow-x: hidden; }
.topbar { position: sticky; top: 0; z-index: 100; background: #fff; border-bottom: 2px solid #1a1814; padding: 0 16px; }
.topbar-inner { display: flex; align-items: center; gap: 12px; height: 52px; max-width: 860px; margin: 0 auto; }
.logo { font-family: 'Outfit', sans-serif; font-weight: 900; font-size: 16px; flex-shrink: 0; white-space: nowrap; }
.logo em { font-style: normal; color: #c94a2a; }
.search-wrap { flex: 1; position: relative; min-width: 0; }
.search-ico { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #999; font-size: 14px; pointer-events: none; }
#search { width: 100%; background: #f5f3ee; border: 1.5px solid #dbd8cf; border-radius: 8px; padding: 7px 12px 7px 30px; font-family: 'Noto Sans JP', sans-serif; font-size: 14px; color: #1a1814; outline: none; -webkit-appearance: none; appearance: none; }
#search:focus { border-color: #1a1814; }
#search::placeholder { color: #aaa; }
.cat-wrap { background: #fff; border-bottom: 1px solid #dbd8cf; }
.cat-inner { display: flex; gap: 6px; overflow-x: auto; padding: 10px 16px; scrollbar-width: none; max-width: 860px; margin: 0 auto; -webkit-overflow-scrolling: touch; }
.cat-inner::-webkit-scrollbar { display: none; }
.cat-btn { flex-shrink: 0; background: #f5f3ee; border: 1.5px solid #dbd8cf; border-radius: 20px; padding: 5px 14px; font-family: 'Noto Sans JP', sans-serif; font-size: 13px; color: #6b6760; cursor: pointer; white-space: nowrap; transition: all .15s; }
.cat-btn.active { background: #1a1814; border-color: #1a1814; color: #fff; }
.main { max-width: 860px; margin: 0 auto; padding: 16px 16px 80px; }
.stats { display: flex; gap: 16px; margin-bottom: 16px; flex-wrap: wrap; }
.stat { display: flex; align-items: baseline; gap: 5px; }
.stat-n { font-family: 'Outfit', sans-serif; font-weight: 700; font-size: 22px; }
.stat-l { font-size: 11px; color: #6b6760; }
.section { margin-bottom: 28px; }
.section-head { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1.5px solid #dbd8cf; }
.section-name { font-family: 'Outfit', sans-serif; font-weight: 700; font-size: 14px; }
.section-cnt { font-family: 'IBM Plex Mono', monospace; font-size: 11px; color: #6b6760; margin-left: auto; }
.card { background: #fff; border: 1.5px solid #dbd8cf; border-radius: 10px; margin-bottom: 8px; overflow: hidden; }
.card-top { display: flex; align-items: flex-start; padding: 12px 14px; cursor: pointer; gap: 10px; -webkit-tap-highlight-color: transparent; }
.card-icon { font-size: 18px; flex-shrink: 0; width: 26px; text-align: center; padding-top: 2px; }
.card-meta { flex: 1; min-width: 0; }
.card-title { font-family: 'Outfit', sans-serif; font-weight: 600; font-size: 14px; word-break: break-all; overflow-wrap: anywhere; }
.card-desc { font-size: 12px; color: #6b6760; margin-top: 2px; word-break: break-all; overflow-wrap: anywhere; }
.card-right { display: flex; align-items: center; gap: 6px; flex-shrink: 0; padding-top: 2px; }
.btn-copy { background: #f5f3ee; border: 1.5px solid #dbd8cf; border-radius: 6px; padding: 4px 10px; font-family: 'IBM Plex Mono', monospace; font-size: 11px; color: #6b6760; cursor: pointer; white-space: nowrap; transition: all .15s; }
.btn-copy.done { border-color: #2a7a52; color: #2a7a52; background: #f0faf5; }
.chevron { color: #aaa; font-size: 11px; transition: transform .2s; flex-shrink: 0; }
.card.open .chevron { transform: rotate(180deg); }
.card-body { display: none; border-top: 1.5px solid #dbd8cf; padding: 14px; background: #f5f3ee; overflow: hidden; }
.card.open .card-body { display: block; }
.md { font-size: 13px; line-height: 1.8; word-break: break-word; overflow-wrap: break-word; }
.md h1,.md h2,.md h3 { font-family: 'Outfit', sans-serif; font-weight: 700; margin: 12px 0 6px; }
.md h1 { font-size: 16px; } .md h2 { font-size: 15px; } .md h3 { font-size: 14px; }
.md p { margin-bottom: 8px; }
.md ul,.md ol { padding-left: 18px; margin-bottom: 8px; }
.md li { margin-bottom: 3px; }
.md strong { font-weight: 700; }
.md code { font-family: 'IBM Plex Mono', monospace; font-size: 11.5px; background: #fff; border: 1px solid #dbd8cf; border-radius: 4px; padding: 1px 5px; color: #c94a2a; word-break: break-all; }
.md pre { background: #1a1814; border-radius: 8px; padding: 12px; overflow-x: auto; margin: 10px 0; max-width: 100%; }
.md pre code { background: none; border: none; padding: 0; color: #e8e4dc; word-break: normal; }
.md blockquote { border-left: 3px solid #d4820a; padding: 6px 12px; color: #6b6760; margin: 8px 0; }
.raw-view { display: none; font-family: 'IBM Plex Mono', monospace; font-size: 12px; line-height: 1.7; background: #fff; border: 1.5px solid #dbd8cf; border-radius: 8px; padding: 12px; white-space: pre-wrap; word-break: break-all; max-height: 300px; overflow-y: auto; margin-top: 10px; }
.raw-view.show { display: block; }
.view-row { display: flex; gap: 6px; margin-top: 10px; flex-wrap: wrap; align-items: center; }
.btn-sm { background: #fff; border: 1.5px solid #dbd8cf; border-radius: 6px; padding: 4px 10px; font-family: 'IBM Plex Mono', monospace; font-size: 11px; color: #6b6760; cursor: pointer; transition: all .15s; }
.btn-sm.active { background: #1a1814; color: #fff; border-color: #1a1814; }
.tags { display: flex; flex-wrap: wrap; gap: 5px; margin-top: 8px; }
.tag { font-family: 'IBM Plex Mono', monospace; font-size: 10px; padding: 2px 8px; border-radius: 4px; background: #eceae3; border: 1px solid #dbd8cf; color: #6b6760; }
.filepath { font-family: 'IBM Plex Mono', monospace; font-size: 10px; color: #aaa; margin-top: 8px; word-break: break-all; }
mark { background: rgba(212,130,10,0.25); border-radius: 2px; }
.empty { text-align: center; padding: 60px 20px; color: #aaa; }
.empty-ico { font-size: 36px; margin-bottom: 10px; }
.empty-txt { font-family: 'Outfit', sans-serif; font-size: 14px; }
.toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%) translateY(60px); background: #2a7a52; color: #fff; font-family: 'IBM Plex Mono', monospace; font-size: 12px; padding: 9px 20px; border-radius: 20px; z-index: 999; pointer-events: none; transition: transform .3s cubic-bezier(.34,1.56,.64,1); white-space: nowrap; }
.toast.show { transform: translateX(-50%) translateY(0); }
.banner { display: none; background: #fff5f0; border: 1.5px solid #c94a2a; border-radius: 10px; padding: 14px 16px; margin-bottom: 16px; font-size: 13px; color: #c94a2a; }
.banner.show { display: block; }
.banner code { font-family: 'IBM Plex Mono', monospace; font-size: 12px; }
</style>
</head>
<body>
<div class="topbar">
  <div class="topbar-inner">
    <div class="logo">PROMPT<em>.</em>LIB</div>
    <div class="search-wrap">
      <span class="search-ico">‚åï</span>
      <input id="search" type="search" placeholder="„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßÊ§úÁ¥¢..." autocomplete="off">
    </div>
  </div>
</div>
<div class="cat-wrap"><div class="cat-inner" id="cat-list"></div></div>
<div class="main">
  <div class="banner" id="banner"><strong>prompts.json „ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ</strong><br>„Çø„Éº„Éü„Éä„É´„Åß <code>python build.py</code> „ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</div>
  <div class="stats" id="stats"></div>
  <div id="list"></div>
</div>
<div class="toast" id="toast"></div>
<script>
let DATA=[],activeCategory='all',query='',cc=0;
const FALLBACK=[{category:"„Çµ„É≥„Éó„É´",icon:"üí°",prompts:[{title:"„Çµ„É≥„Éó„É´",desc:"build.py„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ",tags:[],content:"python build.py „ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",file:""}]}];
async function load(){
  try{const r=await fetch('./prompts.json');if(!r.ok)throw 0;DATA=await r.json();render();}
  catch(e){document.getElementById('banner').classList.add('show');DATA=FALLBACK;render();}
}
function filtered(){
  let all=DATA.flatMap(c=>c.prompts.map(p=>({...p,_cat:c.category,_icon:c.icon})));
  if(activeCategory!=='all')all=all.filter(p=>p._cat===activeCategory);
  if(query){const q=query.toLowerCase();all=all.filter(p=>(p.title||'').toLowerCase().includes(q)||(p.desc||'').toLowerCase().includes(q)||(p.content||'').toLowerCase().includes(q)||(p.tags||[]).some(t=>t.toLowerCase().includes(q)));}
  return all;
}
function esc(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
function hl(s,q){if(!q||!s)return esc(s||'');const e=q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');return esc(s).replace(new RegExp(`(${e})`,'gi'),'<mark>$1</mark>');}
function render(){
  cc=0;
  const items=filtered(),total=DATA.flatMap(c=>c.prompts).length;
  document.getElementById('stats').innerHTML=`<div class="stat"><span class="stat-n">${total}</span><span class="stat-l">„Éó„É≠„É≥„Éó„Éà</span></div><div class="stat"><span class="stat-n">${DATA.length}</span><span class="stat-l">„Ç´„ÉÜ„Ç¥„É™</span></div><div class="stat"><span class="stat-n">${items.length}</span><span class="stat-l">Ë°®Á§∫‰∏≠</span></div>`;
  const catEl=document.getElementById('cat-list');
  catEl.innerHTML=`<button class="cat-btn${activeCategory==='all'?' active':''}" onclick="setCategory('all')">üóÇ „Åô„Åπ„Å¶</button>`;
  DATA.forEach(c=>{catEl.innerHTML+=`<button class="cat-btn${activeCategory===c.category?' active':''}" onclick="setCategory('${c.category.replace(/'/g,"\\'")}')">${c.icon} ${esc(c.category)}</button>`;});
  const listEl=document.getElementById('list');
  if(!items.length){listEl.innerHTML='<div class="empty"><div class="empty-ico">üî≠</div><div class="empty-txt">Ë¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü</div></div>';return;}
  const groups={};
  items.forEach(p=>{if(!groups[p._cat])groups[p._cat]={icon:p._icon,prompts:[]};groups[p._cat].prompts.push(p);});
  listEl.innerHTML=Object.entries(groups).map(([cat,g])=>`<div class="section"><div class="section-head"><span>${g.icon}</span><span class="section-name">${esc(cat)}</span><span class="section-cnt">${g.prompts.length}‰ª∂</span></div>${g.prompts.map(p=>cardHtml(p)).join('')}</div>`).join('');
}
function cardHtml(p){
  const id=`c${++cc}`;
  const tags=(p.tags||[]).map(t=>`<span class="tag">${esc(t)}</span>`).join('');
  return `<div class="card" id="${id}"><div class="card-top" onclick="toggle('${id}',event)"><div class="card-icon">${p._icon||'üìÑ'}</div><div class="card-meta"><div class="card-title">${hl(p.title,query)}</div>${p.desc?`<div class="card-desc">${hl(p.desc,query)}</div>`:''}</div><div class="card-right"><button class="btn-copy" onclick="copyPrompt('${id}',event)">COPY</button><span class="chevron">‚ñæ</span></div></div><div class="card-body"><div class="md" id="${id}-md">${marked.parse(p.content||'')}</div><div class="raw-view" id="${id}-raw">${esc(p.content||'')}</div><div class="view-row"><button class="btn-sm active" id="${id}-bmd" onclick="viewMd('${id}',event)">„Éó„É¨„Éì„É•„Éº</button><button class="btn-sm" id="${id}-braw" onclick="viewRaw('${id}',event)">RAW</button>${tags?`<div class="tags">${tags}</div>`:''}</div>${p.file?`<div class="filepath">üìÅ ${esc(p.file)}</div>`:''}</div></div>`;
}
function toggle(id,e){if(e.target.closest('.btn-copy,.btn-sm'))return;document.getElementById(id).classList.toggle('open');}
function copyPrompt(id,e){e.stopPropagation();const text=document.getElementById(id+'-raw').textContent;navigator.clipboard.writeText(text).then(()=>{const b=e.target;b.textContent='‚úì OK';b.classList.add('done');setTimeout(()=>{b.textContent='COPY';b.classList.remove('done');},2000);toast('„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ');});}
function viewMd(id,e){e.stopPropagation();document.getElementById(id+'-md').style.display='';document.getElementById(id+'-raw').classList.remove('show');document.getElementById(id+'-bmd').classList.add('active');document.getElementById(id+'-braw').classList.remove('active');}
function viewRaw(id,e){e.stopPropagation();document.getElementById(id+'-md').style.display='none';document.getElementById(id+'-raw').classList.add('show');document.getElementById(id+'-braw').classList.add('active');document.getElementById(id+'-bmd').classList.remove('active');}
function setCategory(cat){activeCategory=cat;render();window.scrollTo({top:0,behavior:'smooth'});}
document.getElementById('search').addEventListener('input',function(){query=this.value.trim();activeCategory='all';render();});
function toast(msg){const el=document.getElementById('toast');el.textContent=msg;el.classList.add('show');setTimeout(()=>el.classList.remove('show'),2000);}
load();
</script>
</body>
</html>
